{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/components/GlobalSearch.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useRef } from 'react';\nimport { useRouter } from 'next/navigation';\nimport Link from 'next/link';\nimport Image from 'next/image';\nimport { Search, X, MapPin, Loader2 } from 'lucide-react';\n\ninterface SearchResult {\n  id: number;\n  slug: string;\n  title: string;\n  type: string;\n  typeLabel: string;\n  city?: string;\n  category?: string;\n  image?: string;\n}\n\nexport function GlobalSearch() {\n  const [query, setQuery] = useState('');\n  const [results, setResults] = useState<SearchResult[]>([]);\n  const [isOpen, setIsOpen] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [showMobileSearch, setShowMobileSearch] = useState(false);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const router = useRouter();\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  useEffect(() => {\n    if (query.length < 2) {\n      setResults([]);\n      setIsOpen(false);\n      return;\n    }\n\n    const debounceTimer = setTimeout(async () => {\n      setIsLoading(true);\n      try {\n        const response = await fetch(`/api/search?q=${encodeURIComponent(query)}&limit=8`);\n        const data = await response.json();\n        setResults(data.results || []);\n        setIsOpen(true);\n      } catch (error) {\n        console.error('Search error:', error);\n        setResults([]);\n      } finally {\n        setIsLoading(false);\n      }\n    }, 300);\n\n    return () => clearTimeout(debounceTimer);\n  }, [query]);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (query.trim()) {\n      setIsOpen(false);\n      setShowMobileSearch(false);\n      router.push(`/search?q=${encodeURIComponent(query.trim())}`);\n    }\n  };\n\n  const handleResultClick = () => {\n    setQuery('');\n    setIsOpen(false);\n    setShowMobileSearch(false);\n  };\n\n  const clearSearch = () => {\n    setQuery('');\n    setResults([]);\n    setIsOpen(false);\n    inputRef.current?.focus();\n  };\n\n  const typeColors: Record<string, string> = {\n    restaurant: 'bg-orange-100 text-orange-700',\n    business: 'bg-blue-100 text-blue-700',\n    accommodation: 'bg-purple-100 text-purple-700',\n    places: 'bg-green-100 text-green-700',\n  };\n\n  return (\n    <>\n      <div ref={containerRef} className=\"relative hidden md:block\">\n        <form onSubmit={handleSubmit} className=\"relative\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4\" aria-hidden=\"true\" />\n          <input\n            ref={inputRef}\n            type=\"text\"\n            value={query}\n            onChange={(e) => setQuery(e.target.value)}\n            placeholder=\"Search listings...\"\n            aria-label=\"Search listings\"\n            className=\"w-64 lg:w-80 pl-10 pr-10 py-2.5 bg-slate-100 border border-slate-200 rounded-xl text-slate-900 placeholder-slate-400 focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 focus:bg-white transition-all text-sm\"\n          />\n          {query && (\n            <button\n              type=\"button\"\n              onClick={clearSearch}\n              className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600 focus:outline-none\"\n              aria-label=\"Clear search\"\n            >\n              {isLoading ? (\n                <Loader2 className=\"w-4 h-4 animate-spin\" aria-hidden=\"true\" />\n              ) : (\n                <X className=\"w-4 h-4\" aria-hidden=\"true\" />\n              )}\n            </button>\n          )}\n        </form>\n\n        {isOpen && results.length > 0 && (\n          <div className=\"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-2xl border border-slate-200 overflow-hidden z-50 max-h-[70vh] overflow-y-auto\">\n            <div className=\"p-2\">\n              {results.map((result) => (\n                <Link\n                  key={`${result.type}-${result.id}`}\n                  href={`/${result.type}/${result.slug}`}\n                  onClick={handleResultClick}\n                  className=\"flex items-center gap-3 p-3 rounded-lg hover:bg-slate-50 transition-colors group focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500\"\n                >\n                  {result.image ? (\n                    <div className=\"relative w-12 h-12 rounded-lg overflow-hidden flex-shrink-0\">\n                      <Image\n                        src={result.image}\n                        alt=\"\"\n                        fill\n                        sizes=\"48px\"\n                        className=\"object-cover\"\n                      />\n                    </div>\n                  ) : (\n                    <div className=\"w-12 h-12 rounded-lg bg-slate-100 flex items-center justify-center flex-shrink-0\">\n                      <MapPin className=\"w-5 h-5 text-slate-400\" aria-hidden=\"true\" />\n                    </div>\n                  )}\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"font-medium text-slate-900 truncate group-hover:text-emerald-600 transition-colors\">\n                      {result.title}\n                    </p>\n                    <div className=\"flex items-center gap-2 mt-0.5\">\n                      <span className={`text-xs px-2 py-0.5 rounded-full font-medium ${typeColors[result.type] || 'bg-slate-100 text-slate-600'}`}>\n                        {result.typeLabel}\n                      </span>\n                      {result.city && (\n                        <span className=\"text-xs text-slate-500\">{result.city}</span>\n                      )}\n                    </div>\n                  </div>\n                </Link>\n              ))}\n            </div>\n            <div className=\"border-t border-slate-100 p-2\">\n              <button\n                onClick={() => {\n                  setIsOpen(false);\n                  router.push(`/search?q=${encodeURIComponent(query.trim())}`);\n                }}\n                className=\"w-full text-center py-2 text-sm text-emerald-600 hover:text-emerald-700 font-medium hover:bg-emerald-50 rounded-lg transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500\"\n              >\n                View all results for \"{query}\"\n              </button>\n            </div>\n          </div>\n        )}\n\n        {isOpen && query.length >= 2 && results.length === 0 && !isLoading && (\n          <div className=\"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-2xl border border-slate-200 p-6 text-center z-50\">\n            <p className=\"text-slate-500\">No results found for \"{query}\"</p>\n          </div>\n        )}\n      </div>\n\n      <button\n        onClick={() => setShowMobileSearch(true)}\n        className=\"md:hidden p-2 text-slate-600 hover:text-emerald-600 transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500 rounded-lg\"\n        aria-label=\"Open search\"\n      >\n        <Search className=\"w-5 h-5\" aria-hidden=\"true\" />\n      </button>\n\n      {showMobileSearch && (\n        <div className=\"fixed inset-0 bg-black/50 z-50 md:hidden\" onClick={() => setShowMobileSearch(false)}>\n          <div className=\"bg-white p-4\" onClick={(e) => e.stopPropagation()}>\n            <form onSubmit={handleSubmit} className=\"relative\">\n              <Search className=\"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5\" aria-hidden=\"true\" />\n              <input\n                type=\"text\"\n                value={query}\n                onChange={(e) => setQuery(e.target.value)}\n                placeholder=\"Search listings...\"\n                aria-label=\"Search listings\"\n                autoFocus\n                className=\"w-full pl-12 pr-12 py-4 bg-slate-100 border border-slate-200 rounded-xl text-slate-900 placeholder-slate-400 focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 text-base\"\n              />\n              <button\n                type=\"button\"\n                onClick={() => setShowMobileSearch(false)}\n                className=\"absolute right-4 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600\"\n                aria-label=\"Close search\"\n              >\n                <X className=\"w-5 h-5\" aria-hidden=\"true\" />\n              </button>\n            </form>\n\n            {results.length > 0 && (\n              <div className=\"mt-4 max-h-[60vh] overflow-y-auto\">\n                {results.map((result) => (\n                  <Link\n                    key={`${result.type}-${result.id}`}\n                    href={`/${result.type}/${result.slug}`}\n                    onClick={handleResultClick}\n                    className=\"flex items-center gap-3 p-3 rounded-lg hover:bg-slate-50 transition-colors\"\n                  >\n                    {result.image ? (\n                      <div className=\"relative w-12 h-12 rounded-lg overflow-hidden flex-shrink-0\">\n                        <Image\n                          src={result.image}\n                          alt=\"\"\n                          fill\n                          sizes=\"48px\"\n                          className=\"object-cover\"\n                        />\n                      </div>\n                    ) : (\n                      <div className=\"w-12 h-12 rounded-lg bg-slate-100 flex items-center justify-center flex-shrink-0\">\n                        <MapPin className=\"w-5 h-5 text-slate-400\" aria-hidden=\"true\" />\n                      </div>\n                    )}\n                    <div className=\"flex-1 min-w-0\">\n                      <p className=\"font-medium text-slate-900 truncate\">{result.title}</p>\n                      <div className=\"flex items-center gap-2 mt-0.5\">\n                        <span className={`text-xs px-2 py-0.5 rounded-full font-medium ${typeColors[result.type] || 'bg-slate-100 text-slate-600'}`}>\n                          {result.typeLabel}\n                        </span>\n                        {result.city && (\n                          <span className=\"text-xs text-slate-500\">{result.city}</span>\n                        )}\n                      </div>\n                    </div>\n                  </Link>\n                ))}\n              </div>\n            )}\n\n            {query.length >= 2 && results.length === 0 && !isLoading && (\n              <div className=\"mt-4 p-6 text-center\">\n                <p className=\"text-slate-500\">No results found for \"{query}\"</p>\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}